<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XML Data Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-4xl">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">XML Data Viewer & Tester</h1>
            <p class="mt-2 text-md text-gray-600">Upload your XML file to validate it and display its contents.</p>
        </header>

        <main>
            <!-- File Upload Section -->
            <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
                <label for="xmlFile" class="block text-lg font-semibold mb-3 text-gray-700">1. Select your XML File</label>
                <input type="file" id="xmlFile" accept=".xml,text/xml" class="block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-lg file:border-0
                    file:text-sm file:font-semibold
                    file:bg-violet-50 file:text-violet-700
                    hover:file:bg-violet-100 transition-colors duration-200
                    cursor-pointer"/>
            </div>

            <!-- Validation and Data Display Section -->
            <div id="results" class="mt-8 space-y-8">
                <!-- Validation Status -->
                <div id="validationStatus" class="p-4 rounded-lg text-center font-medium hidden"></div>

                <!-- Comparison Details -->
                <div id="comparisonDetails" class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hidden">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">Comparison Details</h2>
                    <div id="detailsContent" class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-gray-700">
                        <!-- Details will be injected here by JavaScript -->
                    </div>
                </div>

                <!-- Hotel Data Table -->
                <div id="hotelTableContainer" class="bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden hidden">
                     <h2 class="text-2xl font-bold p-6 pb-0 text-gray-800">Hotel Data</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-left text-sm sm:text-base">
                            <thead class="border-b bg-gray-100">
                                <tr>
                                    <th scope="col" class="px-6 py-4 font-semibold text-gray-700">Hotel Name</th>
                                    <th scope="col" class="px-6 py-4 font-semibold text-gray-700 text-center">Stars</th>
                                    <th scope="col" class="px-6 py-4 font-semibold text-gray-700 text-center">Reviews</th>
                                    <th scope="col" class="px-6 py-4 font-semibold text-gray-700 text-center">Score</th>
                                </tr>
                            </thead>
                            <tbody id="hotelData">
                                <!-- Hotel data rows will be injected here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- DOM Element References ---
        const fileInput = document.getElementById('xmlFile');
        const validationStatusEl = document.getElementById('validationStatus');
        const comparisonDetailsContainer = document.getElementById('comparisonDetails');
        const detailsContentEl = document.getElementById('detailsContent');
        const hotelTableContainer = document.getElementById('hotelTableContainer');
        const hotelDataBody = document.getElementById('hotelData');

        // --- Event Listener for File Input ---
        fileInput.addEventListener('change', handleFileSelect);

        /**
         * Handles the file selection event.
         * Reads the file content and triggers the XML parsing process.
         * @param {Event} event - The file input change event.
         */
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) {
                // No file selected, do nothing.
                return;
            }

            // Use FileReader to read the file content as text.
            const reader = new FileReader();
            reader.onload = function(e) {
                const xmlContent = e.target.result;
                parseAndDisplayXML(xmlContent);
            };
            reader.onerror = function() {
                showValidationStatus('Error reading file.', false);
            }
            reader.readAsText(file);
        }

        /**
         * Parses the XML string, checks for errors, and displays the data.
         * @param {string} xmlString - The XML content as a string.
         */
        function parseAndDisplayXML(xmlString) {
            // Use the browser's built-in DOMParser to parse the XML.
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlString, "application/xml");

            // Check for a <parsererror> tag, which indicates the XML is not well-formed.
            const parseError = xmlDoc.querySelector("parsererror");

            if (parseError) {
                // If there's an error, display an error message.
                console.error("XML Parsing Error:", parseError);
                showValidationStatus("XML is not well-formed. Check console for details.", false);
                hideDataSections();
            } else {
                // If parsing is successful, display a success message and the data.
                showValidationStatus("XML is well-formed and parsed successfully!", true);
                displayComparisonDetails(xmlDoc);
                displayHotelData(xmlDoc);
                showDataSections();
            }
        }

        /**
         * Extracts and displays the main attributes from the <comparisons> tag.
         * @param {Document} xmlDoc - The parsed XML document object.
         */
        function displayComparisonDetails(xmlDoc) {
            const comparisons = xmlDoc.querySelector('comparisons');
            if (!comparisons) return;

            // Get attribute values, providing a fallback for safety.
            const dated = comparisons.getAttribute('dated') || 'N/A';
            const location = comparisons.getAttribute('location') || 'N/A';
            const company = comparisons.getAttribute('company') || 'N/A';
            const url = comparisons.getAttribute('url') || 'N/A';

            // Create HTML content for the details section.
            detailsContentEl.innerHTML = `
                <p><span class="font-semibold">Date:</span> ${dated}</p>
                <p><span class="font-semibold">Location:</span> ${location}</p>
                <p><span class="font-semibold">Company:</span> ${company}</p>
                <p><span class="font-semibold">Website:</span> <a href="${url}" target="_blank" class="text-violet-600 hover:underline">${url}</a></p>
            `;
        }

        /**
         * Extracts hotel data, creates table rows, and injects them into the table body.
         * @param {Document} xmlDoc - The parsed XML document object.
         */
        function displayHotelData(xmlDoc) {
            // Clear any previous data from the table body.
            hotelDataBody.innerHTML = '';
            
            const hotels = xmlDoc.querySelectorAll('hotel');
            let isEven = false;

            hotels.forEach(hotel => {
                // Helper to get text content safely.
                const getText = (selector) => hotel.querySelector(selector)?.textContent || 'N/A';

                const name = getText('name');
                const stars = getText('stars');
                const reviews = getText('reviews');
                const score = getText('score');
                
                // Create a new table row element.
                const row = document.createElement('tr');
                row.className = `border-b transition-colors duration-200 ${isEven ? 'bg-gray-50' : 'bg-white'}`;
                
                // Set the inner HTML of the row with the hotel data.
                row.innerHTML = `
                    <td class="px-6 py-4 font-medium text-gray-900">${name}</td>
                    <td class="px-6 py-4 text-center">${stars}</td>
                    <td class="px-6 py-4 text-center">${reviews}</td>
                    <td class="px-6 py-4 text-center font-semibold">${score}</td>
                `;
                
                // Append the new row to the table body.
                hotelDataBody.appendChild(row);
                isEven = !isEven; // Alternate the row colour.
            });
        }

        /**
         * Updates the validation status message and its appearance.
         * @param {string} message - The message to display.
         * @param {boolean} isSuccess - Determines the color (true for green, false for red).
         */
        function showValidationStatus(message, isSuccess) {
            validationStatusEl.textContent = message;
            validationStatusEl.className = `p-4 rounded-lg text-center font-medium ${isSuccess ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`;
            validationStatusEl.classList.remove('hidden');
        }
        
        /**
         * Hides all data display sections.
         */
        function hideDataSections() {
            comparisonDetailsContainer.classList.add('hidden');
            hotelTableContainer.classList.add('hidden');
        }

        /**
         * Shows all data display sections.
         */
        function showDataSections() {
            comparisonDetailsContainer.classList.remove('hidden');
            hotelTableContainer.classList.remove('hidden');
        }

    </script>
</body>
</html>